// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package provider

import (
	"context"
	"encoding/json"
	"github.com/conductorone/terraform-provider-conductorone/internal/provider/typeconvert"
	tfTypes "github.com/conductorone/terraform-provider-conductorone/internal/provider/types"
	"github.com/conductorone/terraform-provider-conductorone/internal/sdk/models/operations"
	"github.com/conductorone/terraform-provider-conductorone/internal/sdk/models/shared"
	"github.com/hashicorp/terraform-plugin-framework-jsontypes/jsontypes"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"
	"time"
)

func (r *CustomAppEntitlementResourceModel) RefreshFromSharedAppEntitlement(ctx context.Context, resp *shared.AppEntitlement) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		r.Alias = types.StringPointerValue(resp.Alias)
		r.AppID = types.StringPointerValue(resp.AppID)
		r.AppResourceID = types.StringPointerValue(resp.AppResourceID)
		r.AppResourceTypeID = types.StringPointerValue(resp.AppResourceTypeID)
		r.CertifyPolicyID = types.StringPointerValue(resp.CertifyPolicyID)
		if resp.ComplianceFrameworkValueIds != nil {
			r.ComplianceFrameworkValueIds = make([]types.String, 0, len(resp.ComplianceFrameworkValueIds))
			for _, v := range resp.ComplianceFrameworkValueIds {
				r.ComplianceFrameworkValueIds = append(r.ComplianceFrameworkValueIds, types.StringValue(v))
			}
		}
		r.CreatedAt = types.StringPointerValue(typeconvert.TimePointerToStringPointer(resp.CreatedAt))
		r.DefaultValuesApplied = types.BoolPointerValue(resp.DefaultValuesApplied)
		r.DeletedAt = types.StringPointerValue(typeconvert.TimePointerToStringPointer(resp.DeletedAt))
		if resp.DeprovisionerPolicy == nil {
			r.DeprovisionerPolicy = nil
		} else {
			r.DeprovisionerPolicy = &tfTypes.DeprovisionerPolicy{}
			if resp.DeprovisionerPolicy.Connector == nil {
				r.DeprovisionerPolicy.Connector = nil
			} else {
				r.DeprovisionerPolicy.Connector = &tfTypes.ConnectorProvision{}
				if resp.DeprovisionerPolicy.Connector.Account == nil {
					r.DeprovisionerPolicy.Connector.Account = nil
				} else {
					r.DeprovisionerPolicy.Connector.Account = &tfTypes.AccountProvision{}
					if resp.DeprovisionerPolicy.Connector.Account.Config == nil {
						r.DeprovisionerPolicy.Connector.Account.Config = nil
					} else {
						r.DeprovisionerPolicy.Connector.Account.Config = &tfTypes.Config{}
					}
					r.DeprovisionerPolicy.Connector.Account.ConnectorID = types.StringPointerValue(resp.DeprovisionerPolicy.Connector.Account.ConnectorID)
					if resp.DeprovisionerPolicy.Connector.Account.DoNotSave == nil {
						r.DeprovisionerPolicy.Connector.Account.DoNotSave = nil
					} else {
						r.DeprovisionerPolicy.Connector.Account.DoNotSave = &tfTypes.DoNotSave{}
					}
					if resp.DeprovisionerPolicy.Connector.Account.SaveToVault == nil {
						r.DeprovisionerPolicy.Connector.Account.SaveToVault = nil
					} else {
						r.DeprovisionerPolicy.Connector.Account.SaveToVault = &tfTypes.SaveToVault{}
						if resp.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds != nil {
							r.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds = make([]types.String, 0, len(resp.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds))
							for _, v := range resp.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds {
								r.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds = append(r.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds, types.StringValue(v))
							}
						}
					}
					r.DeprovisionerPolicy.Connector.Account.SchemaID = types.StringPointerValue(resp.DeprovisionerPolicy.Connector.Account.SchemaID)
				}
				if resp.DeprovisionerPolicy.Connector.DefaultBehavior == nil {
					r.DeprovisionerPolicy.Connector.DefaultBehavior = nil
				} else {
					r.DeprovisionerPolicy.Connector.DefaultBehavior = &tfTypes.DefaultBehavior{}
					r.DeprovisionerPolicy.Connector.DefaultBehavior.ConnectorID = types.StringPointerValue(resp.DeprovisionerPolicy.Connector.DefaultBehavior.ConnectorID)
				}
				if resp.DeprovisionerPolicy.Connector.DeleteAccount == nil {
					r.DeprovisionerPolicy.Connector.DeleteAccount = nil
				} else {
					r.DeprovisionerPolicy.Connector.DeleteAccount = &tfTypes.DeleteAccount{}
					r.DeprovisionerPolicy.Connector.DeleteAccount.ConnectorID = types.StringPointerValue(resp.DeprovisionerPolicy.Connector.DeleteAccount.ConnectorID)
				}
			}
			if resp.DeprovisionerPolicy.Delegated == nil {
				r.DeprovisionerPolicy.Delegated = nil
			} else {
				r.DeprovisionerPolicy.Delegated = &tfTypes.DelegatedProvision{}
				r.DeprovisionerPolicy.Delegated.AppID = types.StringPointerValue(resp.DeprovisionerPolicy.Delegated.AppID)
				r.DeprovisionerPolicy.Delegated.EntitlementID = types.StringPointerValue(resp.DeprovisionerPolicy.Delegated.EntitlementID)
			}
			if resp.DeprovisionerPolicy.ExternalTicket == nil {
				r.DeprovisionerPolicy.ExternalTicket = nil
			} else {
				r.DeprovisionerPolicy.ExternalTicket = &tfTypes.ExternalTicketProvision{}
				r.DeprovisionerPolicy.ExternalTicket.AppID = types.StringPointerValue(resp.DeprovisionerPolicy.ExternalTicket.AppID)
				r.DeprovisionerPolicy.ExternalTicket.ConnectorID = types.StringPointerValue(resp.DeprovisionerPolicy.ExternalTicket.ConnectorID)
				r.DeprovisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID = types.StringPointerValue(resp.DeprovisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID)
				r.DeprovisionerPolicy.ExternalTicket.Instructions = types.StringPointerValue(resp.DeprovisionerPolicy.ExternalTicket.Instructions)
			}
			if resp.DeprovisionerPolicy.Manual == nil {
				r.DeprovisionerPolicy.Manual = nil
			} else {
				r.DeprovisionerPolicy.Manual = &tfTypes.ManualProvision{}
				r.DeprovisionerPolicy.Manual.Instructions = types.StringPointerValue(resp.DeprovisionerPolicy.Manual.Instructions)
				if resp.DeprovisionerPolicy.Manual.UserIds != nil {
					r.DeprovisionerPolicy.Manual.UserIds = make([]types.String, 0, len(resp.DeprovisionerPolicy.Manual.UserIds))
					for _, v := range resp.DeprovisionerPolicy.Manual.UserIds {
						r.DeprovisionerPolicy.Manual.UserIds = append(r.DeprovisionerPolicy.Manual.UserIds, types.StringValue(v))
					}
				}
			}
			if resp.DeprovisionerPolicy.MultiStep == nil {
				r.DeprovisionerPolicy.MultiStep = jsontypes.NewNormalizedNull()
			} else {
				multiStepResult, _ := json.Marshal(resp.DeprovisionerPolicy.MultiStep)
				r.DeprovisionerPolicy.MultiStep = jsontypes.NewNormalizedValue(string(multiStepResult))
			}
			if resp.DeprovisionerPolicy.Unconfigured == nil {
				r.DeprovisionerPolicy.Unconfigured = nil
			} else {
				r.DeprovisionerPolicy.Unconfigured = &tfTypes.UnconfiguredProvision{}
			}
			if resp.DeprovisionerPolicy.Webhook == nil {
				r.DeprovisionerPolicy.Webhook = nil
			} else {
				r.DeprovisionerPolicy.Webhook = &tfTypes.WebhookProvision{}
				r.DeprovisionerPolicy.Webhook.WebhookID = types.StringPointerValue(resp.DeprovisionerPolicy.Webhook.WebhookID)
			}
		}
		r.Description = types.StringPointerValue(resp.Description)
		r.DisplayName = types.StringPointerValue(resp.DisplayName)
		r.DurationGrant = types.StringPointerValue(resp.DurationGrant)
		if resp.DurationUnset == nil {
			r.DurationUnset = nil
		} else {
			r.DurationUnset = &tfTypes.CreateAppEntitlementRequestDurationUnset{}
		}
		r.EmergencyGrantEnabled = types.BoolPointerValue(resp.EmergencyGrantEnabled)
		r.EmergencyGrantPolicyID = types.StringPointerValue(resp.EmergencyGrantPolicyID)
		r.GrantCount = types.StringPointerValue(resp.GrantCount)
		r.GrantPolicyID = types.StringPointerValue(resp.GrantPolicyID)
		r.ID = types.StringPointerValue(resp.ID)
		r.IsAutomationEnabled = types.BoolPointerValue(resp.IsAutomationEnabled)
		r.IsManuallyManaged = types.BoolPointerValue(resp.IsManuallyManaged)
		r.MatchBatonID = types.StringPointerValue(resp.MatchBatonID)
		r.OverrideAccessRequestsDefaults = types.BoolPointerValue(resp.OverrideAccessRequestsDefaults)
		if resp.ProvisionerPolicy == nil {
			r.ProvisionerPolicy = nil
		} else {
			r.ProvisionerPolicy = &tfTypes.ProvisionPolicy{}
			if resp.ProvisionerPolicy.Connector == nil {
				r.ProvisionerPolicy.Connector = nil
			} else {
				r.ProvisionerPolicy.Connector = &tfTypes.ConnectorProvision{}
				if resp.ProvisionerPolicy.Connector.Account == nil {
					r.ProvisionerPolicy.Connector.Account = nil
				} else {
					r.ProvisionerPolicy.Connector.Account = &tfTypes.AccountProvision{}
					if resp.ProvisionerPolicy.Connector.Account.Config == nil {
						r.ProvisionerPolicy.Connector.Account.Config = nil
					} else {
						r.ProvisionerPolicy.Connector.Account.Config = &tfTypes.Config{}
					}
					r.ProvisionerPolicy.Connector.Account.ConnectorID = types.StringPointerValue(resp.ProvisionerPolicy.Connector.Account.ConnectorID)
					if resp.ProvisionerPolicy.Connector.Account.DoNotSave == nil {
						r.ProvisionerPolicy.Connector.Account.DoNotSave = nil
					} else {
						r.ProvisionerPolicy.Connector.Account.DoNotSave = &tfTypes.DoNotSave{}
					}
					if resp.ProvisionerPolicy.Connector.Account.SaveToVault == nil {
						r.ProvisionerPolicy.Connector.Account.SaveToVault = nil
					} else {
						r.ProvisionerPolicy.Connector.Account.SaveToVault = &tfTypes.SaveToVault{}
						if resp.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds != nil {
							r.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds = make([]types.String, 0, len(resp.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds))
							for _, v := range resp.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds {
								r.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds = append(r.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds, types.StringValue(v))
							}
						}
					}
					r.ProvisionerPolicy.Connector.Account.SchemaID = types.StringPointerValue(resp.ProvisionerPolicy.Connector.Account.SchemaID)
				}
				if resp.ProvisionerPolicy.Connector.DefaultBehavior == nil {
					r.ProvisionerPolicy.Connector.DefaultBehavior = nil
				} else {
					r.ProvisionerPolicy.Connector.DefaultBehavior = &tfTypes.DefaultBehavior{}
					r.ProvisionerPolicy.Connector.DefaultBehavior.ConnectorID = types.StringPointerValue(resp.ProvisionerPolicy.Connector.DefaultBehavior.ConnectorID)
				}
				if resp.ProvisionerPolicy.Connector.DeleteAccount == nil {
					r.ProvisionerPolicy.Connector.DeleteAccount = nil
				} else {
					r.ProvisionerPolicy.Connector.DeleteAccount = &tfTypes.DeleteAccount{}
					r.ProvisionerPolicy.Connector.DeleteAccount.ConnectorID = types.StringPointerValue(resp.ProvisionerPolicy.Connector.DeleteAccount.ConnectorID)
				}
			}
			if resp.ProvisionerPolicy.Delegated == nil {
				r.ProvisionerPolicy.Delegated = nil
			} else {
				r.ProvisionerPolicy.Delegated = &tfTypes.DelegatedProvision{}
				r.ProvisionerPolicy.Delegated.AppID = types.StringPointerValue(resp.ProvisionerPolicy.Delegated.AppID)
				r.ProvisionerPolicy.Delegated.EntitlementID = types.StringPointerValue(resp.ProvisionerPolicy.Delegated.EntitlementID)
			}
			if resp.ProvisionerPolicy.ExternalTicket == nil {
				r.ProvisionerPolicy.ExternalTicket = nil
			} else {
				r.ProvisionerPolicy.ExternalTicket = &tfTypes.ExternalTicketProvision{}
				r.ProvisionerPolicy.ExternalTicket.AppID = types.StringPointerValue(resp.ProvisionerPolicy.ExternalTicket.AppID)
				r.ProvisionerPolicy.ExternalTicket.ConnectorID = types.StringPointerValue(resp.ProvisionerPolicy.ExternalTicket.ConnectorID)
				r.ProvisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID = types.StringPointerValue(resp.ProvisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID)
				r.ProvisionerPolicy.ExternalTicket.Instructions = types.StringPointerValue(resp.ProvisionerPolicy.ExternalTicket.Instructions)
			}
			if resp.ProvisionerPolicy.Manual == nil {
				r.ProvisionerPolicy.Manual = nil
			} else {
				r.ProvisionerPolicy.Manual = &tfTypes.ManualProvision{}
				r.ProvisionerPolicy.Manual.Instructions = types.StringPointerValue(resp.ProvisionerPolicy.Manual.Instructions)
				if resp.ProvisionerPolicy.Manual.UserIds != nil {
					r.ProvisionerPolicy.Manual.UserIds = make([]types.String, 0, len(resp.ProvisionerPolicy.Manual.UserIds))
					for _, v := range resp.ProvisionerPolicy.Manual.UserIds {
						r.ProvisionerPolicy.Manual.UserIds = append(r.ProvisionerPolicy.Manual.UserIds, types.StringValue(v))
					}
				}
			}
			if resp.ProvisionerPolicy.MultiStep == nil {
				r.ProvisionerPolicy.MultiStep = jsontypes.NewNormalizedNull()
			} else {
				multiStepResult1, _ := json.Marshal(resp.ProvisionerPolicy.MultiStep)
				r.ProvisionerPolicy.MultiStep = jsontypes.NewNormalizedValue(string(multiStepResult1))
			}
			if resp.ProvisionerPolicy.Unconfigured == nil {
				r.ProvisionerPolicy.Unconfigured = nil
			} else {
				r.ProvisionerPolicy.Unconfigured = &tfTypes.UnconfiguredProvision{}
			}
			if resp.ProvisionerPolicy.Webhook == nil {
				r.ProvisionerPolicy.Webhook = nil
			} else {
				r.ProvisionerPolicy.Webhook = &tfTypes.WebhookProvision{}
				r.ProvisionerPolicy.Webhook.WebhookID = types.StringPointerValue(resp.ProvisionerPolicy.Webhook.WebhookID)
			}
		}
		if resp.Purpose != nil {
			r.Purpose = types.StringValue(string(*resp.Purpose))
		} else {
			r.Purpose = types.StringNull()
		}
		r.RequestSchemaID = types.StringPointerValue(resp.RequestSchemaID)
		r.RevokePolicyID = types.StringPointerValue(resp.RevokePolicyID)
		r.RiskLevelValueID = types.StringPointerValue(resp.RiskLevelValueID)
		r.Slug = types.StringPointerValue(resp.Slug)
		if resp.SourceConnectorIds != nil {
			r.SourceConnectorIds = make(map[string]types.String, len(resp.SourceConnectorIds))
			for key, value := range resp.SourceConnectorIds {
				r.SourceConnectorIds[key] = types.StringValue(value)
			}
		}
		r.SystemBuiltin = types.BoolPointerValue(resp.SystemBuiltin)
		r.UpdatedAt = types.StringPointerValue(typeconvert.TimePointerToStringPointer(resp.UpdatedAt))
	}

	return diags
}

func (r *CustomAppEntitlementResourceModel) ToOperationsC1APIAppV1AppEntitlementsCreateRequest(ctx context.Context) (*operations.C1APIAppV1AppEntitlementsCreateRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	appID := new(string)
	if !r.AppID.IsUnknown() && !r.AppID.IsNull() {
		*appID = r.AppID.ValueString()
	} else {
		appID = nil
	}
	createAppEntitlementRequest, createAppEntitlementRequestDiags := r.ToSharedCreateAppEntitlementRequest(ctx)
	diags.Append(createAppEntitlementRequestDiags...)

	if diags.HasError() {
		return nil, diags
	}

	out := operations.C1APIAppV1AppEntitlementsCreateRequest{
		AppID:                       appID,
		CreateAppEntitlementRequest: createAppEntitlementRequest,
	}

	return &out, diags
}

func (r *CustomAppEntitlementResourceModel) ToOperationsC1APIAppV1AppEntitlementsDeleteRequest(ctx context.Context) (*operations.C1APIAppV1AppEntitlementsDeleteRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	appID := new(string)
	if !r.AppID.IsUnknown() && !r.AppID.IsNull() {
		*appID = r.AppID.ValueString()
	} else {
		appID = nil
	}
	id := new(string)
	if !r.ID.IsUnknown() && !r.ID.IsNull() {
		*id = r.ID.ValueString()
	} else {
		id = nil
	}
	out := operations.C1APIAppV1AppEntitlementsDeleteRequest{
		AppID: appID,
		ID:    id,
	}

	return &out, diags
}

func (r *CustomAppEntitlementResourceModel) ToOperationsC1APIAppV1AppEntitlementsGetRequest(ctx context.Context) (*operations.C1APIAppV1AppEntitlementsGetRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	appID := new(string)
	if !r.AppID.IsUnknown() && !r.AppID.IsNull() {
		*appID = r.AppID.ValueString()
	} else {
		appID = nil
	}
	id := new(string)
	if !r.ID.IsUnknown() && !r.ID.IsNull() {
		*id = r.ID.ValueString()
	} else {
		id = nil
	}
	out := operations.C1APIAppV1AppEntitlementsGetRequest{
		AppID: appID,
		ID:    id,
	}

	return &out, diags
}

func (r *CustomAppEntitlementResourceModel) ToOperationsC1APIAppV1AppEntitlementsUpdateRequest(ctx context.Context) (*operations.C1APIAppV1AppEntitlementsUpdateRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	appID := new(string)
	if !r.AppID.IsUnknown() && !r.AppID.IsNull() {
		*appID = r.AppID.ValueString()
	} else {
		appID = nil
	}
	id := new(string)
	if !r.ID.IsUnknown() && !r.ID.IsNull() {
		*id = r.ID.ValueString()
	} else {
		id = nil
	}
	updateAppEntitlementRequest, updateAppEntitlementRequestDiags := r.ToSharedUpdateAppEntitlementRequest(ctx)
	diags.Append(updateAppEntitlementRequestDiags...)

	if diags.HasError() {
		return nil, diags
	}

	out := operations.C1APIAppV1AppEntitlementsUpdateRequest{
		AppID:                       appID,
		ID:                          id,
		UpdateAppEntitlementRequest: updateAppEntitlementRequest,
	}

	return &out, diags
}

func (r *CustomAppEntitlementResourceModel) ToSharedAppEntitlementInput(ctx context.Context) (*shared.AppEntitlementInput, diag.Diagnostics) {
	var diags diag.Diagnostics

	alias := new(string)
	if !r.Alias.IsUnknown() && !r.Alias.IsNull() {
		*alias = r.Alias.ValueString()
	} else {
		alias = nil
	}
	appID := new(string)
	if !r.AppID.IsUnknown() && !r.AppID.IsNull() {
		*appID = r.AppID.ValueString()
	} else {
		appID = nil
	}
	appResourceID := new(string)
	if !r.AppResourceID.IsUnknown() && !r.AppResourceID.IsNull() {
		*appResourceID = r.AppResourceID.ValueString()
	} else {
		appResourceID = nil
	}
	appResourceTypeID := new(string)
	if !r.AppResourceTypeID.IsUnknown() && !r.AppResourceTypeID.IsNull() {
		*appResourceTypeID = r.AppResourceTypeID.ValueString()
	} else {
		appResourceTypeID = nil
	}
	certifyPolicyID := new(string)
	if !r.CertifyPolicyID.IsUnknown() && !r.CertifyPolicyID.IsNull() {
		*certifyPolicyID = r.CertifyPolicyID.ValueString()
	} else {
		certifyPolicyID = nil
	}
	var complianceFrameworkValueIds []string
	if r.ComplianceFrameworkValueIds != nil {
		complianceFrameworkValueIds = make([]string, 0, len(r.ComplianceFrameworkValueIds))
		for _, complianceFrameworkValueIdsItem := range r.ComplianceFrameworkValueIds {
			complianceFrameworkValueIds = append(complianceFrameworkValueIds, complianceFrameworkValueIdsItem.ValueString())
		}
	}
	createdAt := new(time.Time)
	if !r.CreatedAt.IsUnknown() && !r.CreatedAt.IsNull() {
		*createdAt, _ = time.Parse(time.RFC3339Nano, r.CreatedAt.ValueString())
	} else {
		createdAt = nil
	}
	defaultValuesApplied := new(bool)
	if !r.DefaultValuesApplied.IsUnknown() && !r.DefaultValuesApplied.IsNull() {
		*defaultValuesApplied = r.DefaultValuesApplied.ValueBool()
	} else {
		defaultValuesApplied = nil
	}
	deletedAt := new(time.Time)
	if !r.DeletedAt.IsUnknown() && !r.DeletedAt.IsNull() {
		*deletedAt, _ = time.Parse(time.RFC3339Nano, r.DeletedAt.ValueString())
	} else {
		deletedAt = nil
	}
	description := new(string)
	if !r.Description.IsUnknown() && !r.Description.IsNull() {
		*description = r.Description.ValueString()
	} else {
		description = nil
	}
	displayName := new(string)
	if !r.DisplayName.IsUnknown() && !r.DisplayName.IsNull() {
		*displayName = r.DisplayName.ValueString()
	} else {
		displayName = nil
	}
	durationGrant := new(string)
	if !r.DurationGrant.IsUnknown() && !r.DurationGrant.IsNull() {
		*durationGrant = r.DurationGrant.ValueString()
	} else {
		durationGrant = nil
	}
	var durationUnset *shared.AppEntitlementDurationUnset
	if r.DurationUnset != nil {
		durationUnset = &shared.AppEntitlementDurationUnset{}
	}
	emergencyGrantEnabled := new(bool)
	if !r.EmergencyGrantEnabled.IsUnknown() && !r.EmergencyGrantEnabled.IsNull() {
		*emergencyGrantEnabled = r.EmergencyGrantEnabled.ValueBool()
	} else {
		emergencyGrantEnabled = nil
	}
	emergencyGrantPolicyID := new(string)
	if !r.EmergencyGrantPolicyID.IsUnknown() && !r.EmergencyGrantPolicyID.IsNull() {
		*emergencyGrantPolicyID = r.EmergencyGrantPolicyID.ValueString()
	} else {
		emergencyGrantPolicyID = nil
	}
	grantPolicyID := new(string)
	if !r.GrantPolicyID.IsUnknown() && !r.GrantPolicyID.IsNull() {
		*grantPolicyID = r.GrantPolicyID.ValueString()
	} else {
		grantPolicyID = nil
	}
	isManuallyManaged := new(bool)
	if !r.IsManuallyManaged.IsUnknown() && !r.IsManuallyManaged.IsNull() {
		*isManuallyManaged = r.IsManuallyManaged.ValueBool()
	} else {
		isManuallyManaged = nil
	}
	matchBatonID := new(string)
	if !r.MatchBatonID.IsUnknown() && !r.MatchBatonID.IsNull() {
		*matchBatonID = r.MatchBatonID.ValueString()
	} else {
		matchBatonID = nil
	}
	overrideAccessRequestsDefaults := new(bool)
	if !r.OverrideAccessRequestsDefaults.IsUnknown() && !r.OverrideAccessRequestsDefaults.IsNull() {
		*overrideAccessRequestsDefaults = r.OverrideAccessRequestsDefaults.ValueBool()
	} else {
		overrideAccessRequestsDefaults = nil
	}
	var provisionerPolicy *shared.ProvisionPolicy
	if r.ProvisionerPolicy != nil {
		var connector *shared.ConnectorProvision
		if r.ProvisionerPolicy.Connector != nil {
			var account *shared.AccountProvision
			if r.ProvisionerPolicy.Connector.Account != nil {
				var config *shared.Config
				if r.ProvisionerPolicy.Connector.Account.Config != nil {
					config = &shared.Config{}
				}
				connectorID := new(string)
				if !r.ProvisionerPolicy.Connector.Account.ConnectorID.IsUnknown() && !r.ProvisionerPolicy.Connector.Account.ConnectorID.IsNull() {
					*connectorID = r.ProvisionerPolicy.Connector.Account.ConnectorID.ValueString()
				} else {
					connectorID = nil
				}
				var doNotSave *shared.DoNotSave
				if r.ProvisionerPolicy.Connector.Account.DoNotSave != nil {
					doNotSave = &shared.DoNotSave{}
				}
				var saveToVault *shared.SaveToVault
				if r.ProvisionerPolicy.Connector.Account.SaveToVault != nil {
					var vaultIds []string
					if r.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds != nil {
						vaultIds = make([]string, 0, len(r.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds))
						for _, vaultIdsItem := range r.ProvisionerPolicy.Connector.Account.SaveToVault.VaultIds {
							vaultIds = append(vaultIds, vaultIdsItem.ValueString())
						}
					}
					saveToVault = &shared.SaveToVault{
						VaultIds: vaultIds,
					}
				}
				schemaID := new(string)
				if !r.ProvisionerPolicy.Connector.Account.SchemaID.IsUnknown() && !r.ProvisionerPolicy.Connector.Account.SchemaID.IsNull() {
					*schemaID = r.ProvisionerPolicy.Connector.Account.SchemaID.ValueString()
				} else {
					schemaID = nil
				}
				account = &shared.AccountProvision{
					Config:      config,
					ConnectorID: connectorID,
					DoNotSave:   doNotSave,
					SaveToVault: saveToVault,
					SchemaID:    schemaID,
				}
			}
			var defaultBehavior *shared.DefaultBehavior
			if r.ProvisionerPolicy.Connector.DefaultBehavior != nil {
				connectorId1 := new(string)
				if !r.ProvisionerPolicy.Connector.DefaultBehavior.ConnectorID.IsUnknown() && !r.ProvisionerPolicy.Connector.DefaultBehavior.ConnectorID.IsNull() {
					*connectorId1 = r.ProvisionerPolicy.Connector.DefaultBehavior.ConnectorID.ValueString()
				} else {
					connectorId1 = nil
				}
				defaultBehavior = &shared.DefaultBehavior{
					ConnectorID: connectorId1,
				}
			}
			var deleteAccount *shared.DeleteAccount
			if r.ProvisionerPolicy.Connector.DeleteAccount != nil {
				connectorId2 := new(string)
				if !r.ProvisionerPolicy.Connector.DeleteAccount.ConnectorID.IsUnknown() && !r.ProvisionerPolicy.Connector.DeleteAccount.ConnectorID.IsNull() {
					*connectorId2 = r.ProvisionerPolicy.Connector.DeleteAccount.ConnectorID.ValueString()
				} else {
					connectorId2 = nil
				}
				deleteAccount = &shared.DeleteAccount{
					ConnectorID: connectorId2,
				}
			}
			connector = &shared.ConnectorProvision{
				Account:         account,
				DefaultBehavior: defaultBehavior,
				DeleteAccount:   deleteAccount,
			}
		}
		var delegated *shared.DelegatedProvision
		if r.ProvisionerPolicy.Delegated != nil {
			appId1 := new(string)
			if !r.ProvisionerPolicy.Delegated.AppID.IsUnknown() && !r.ProvisionerPolicy.Delegated.AppID.IsNull() {
				*appId1 = r.ProvisionerPolicy.Delegated.AppID.ValueString()
			} else {
				appId1 = nil
			}
			entitlementID := new(string)
			if !r.ProvisionerPolicy.Delegated.EntitlementID.IsUnknown() && !r.ProvisionerPolicy.Delegated.EntitlementID.IsNull() {
				*entitlementID = r.ProvisionerPolicy.Delegated.EntitlementID.ValueString()
			} else {
				entitlementID = nil
			}
			delegated = &shared.DelegatedProvision{
				AppID:         appId1,
				EntitlementID: entitlementID,
			}
		}
		var externalTicket *shared.ExternalTicketProvision
		if r.ProvisionerPolicy.ExternalTicket != nil {
			appId2 := new(string)
			if !r.ProvisionerPolicy.ExternalTicket.AppID.IsUnknown() && !r.ProvisionerPolicy.ExternalTicket.AppID.IsNull() {
				*appId2 = r.ProvisionerPolicy.ExternalTicket.AppID.ValueString()
			} else {
				appId2 = nil
			}
			connectorId3 := new(string)
			if !r.ProvisionerPolicy.ExternalTicket.ConnectorID.IsUnknown() && !r.ProvisionerPolicy.ExternalTicket.ConnectorID.IsNull() {
				*connectorId3 = r.ProvisionerPolicy.ExternalTicket.ConnectorID.ValueString()
			} else {
				connectorId3 = nil
			}
			externalTicketProvisionerConfigID := new(string)
			if !r.ProvisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.IsUnknown() && !r.ProvisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.IsNull() {
				*externalTicketProvisionerConfigID = r.ProvisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.ValueString()
			} else {
				externalTicketProvisionerConfigID = nil
			}
			instructions := new(string)
			if !r.ProvisionerPolicy.ExternalTicket.Instructions.IsUnknown() && !r.ProvisionerPolicy.ExternalTicket.Instructions.IsNull() {
				*instructions = r.ProvisionerPolicy.ExternalTicket.Instructions.ValueString()
			} else {
				instructions = nil
			}
			externalTicket = &shared.ExternalTicketProvision{
				AppID:                             appId2,
				ConnectorID:                       connectorId3,
				ExternalTicketProvisionerConfigID: externalTicketProvisionerConfigID,
				Instructions:                      instructions,
			}
		}
		var manual *shared.ManualProvision
		if r.ProvisionerPolicy.Manual != nil {
			instructions1 := new(string)
			if !r.ProvisionerPolicy.Manual.Instructions.IsUnknown() && !r.ProvisionerPolicy.Manual.Instructions.IsNull() {
				*instructions1 = r.ProvisionerPolicy.Manual.Instructions.ValueString()
			} else {
				instructions1 = nil
			}
			var userIds []string
			if r.ProvisionerPolicy.Manual.UserIds != nil {
				userIds = make([]string, 0, len(r.ProvisionerPolicy.Manual.UserIds))
				for _, userIdsItem := range r.ProvisionerPolicy.Manual.UserIds {
					userIds = append(userIds, userIdsItem.ValueString())
				}
			}
			manual = &shared.ManualProvision{
				Instructions: instructions1,
				UserIds:      userIds,
			}
		}
		var multiStep interface{}
		if !r.ProvisionerPolicy.MultiStep.IsUnknown() && !r.ProvisionerPolicy.MultiStep.IsNull() {
			_ = json.Unmarshal([]byte(r.ProvisionerPolicy.MultiStep.ValueString()), &multiStep)
		}
		var unconfigured *shared.UnconfiguredProvision
		if r.ProvisionerPolicy.Unconfigured != nil {
			unconfigured = &shared.UnconfiguredProvision{}
		}
		var webhook *shared.WebhookProvision
		if r.ProvisionerPolicy.Webhook != nil {
			webhookID := new(string)
			if !r.ProvisionerPolicy.Webhook.WebhookID.IsUnknown() && !r.ProvisionerPolicy.Webhook.WebhookID.IsNull() {
				*webhookID = r.ProvisionerPolicy.Webhook.WebhookID.ValueString()
			} else {
				webhookID = nil
			}
			webhook = &shared.WebhookProvision{
				WebhookID: webhookID,
			}
		}
		provisionerPolicy = &shared.ProvisionPolicy{
			Connector:      connector,
			Delegated:      delegated,
			ExternalTicket: externalTicket,
			Manual:         manual,
			MultiStep:      multiStep,
			Unconfigured:   unconfigured,
			Webhook:        webhook,
		}
	}
	purpose := new(shared.Purpose)
	if !r.Purpose.IsUnknown() && !r.Purpose.IsNull() {
		*purpose = shared.Purpose(r.Purpose.ValueString())
	} else {
		purpose = nil
	}
	requestSchemaID := new(string)
	if !r.RequestSchemaID.IsUnknown() && !r.RequestSchemaID.IsNull() {
		*requestSchemaID = r.RequestSchemaID.ValueString()
	} else {
		requestSchemaID = nil
	}
	revokePolicyID := new(string)
	if !r.RevokePolicyID.IsUnknown() && !r.RevokePolicyID.IsNull() {
		*revokePolicyID = r.RevokePolicyID.ValueString()
	} else {
		revokePolicyID = nil
	}
	riskLevelValueID := new(string)
	if !r.RiskLevelValueID.IsUnknown() && !r.RiskLevelValueID.IsNull() {
		*riskLevelValueID = r.RiskLevelValueID.ValueString()
	} else {
		riskLevelValueID = nil
	}
	slug := new(string)
	if !r.Slug.IsUnknown() && !r.Slug.IsNull() {
		*slug = r.Slug.ValueString()
	} else {
		slug = nil
	}
	sourceConnectorIds := make(map[string]string)
	for sourceConnectorIdsKey, sourceConnectorIdsValue := range r.SourceConnectorIds {
		var sourceConnectorIdsInst string
		sourceConnectorIdsInst = sourceConnectorIdsValue.ValueString()

		sourceConnectorIds[sourceConnectorIdsKey] = sourceConnectorIdsInst
	}
	updatedAt := new(time.Time)
	if !r.UpdatedAt.IsUnknown() && !r.UpdatedAt.IsNull() {
		*updatedAt, _ = time.Parse(time.RFC3339Nano, r.UpdatedAt.ValueString())
	} else {
		updatedAt = nil
	}
	var deprovisionerPolicy *shared.DeprovisionerPolicy
	if r.DeprovisionerPolicy != nil {
		var connector1 *shared.ConnectorProvision
		if r.DeprovisionerPolicy.Connector != nil {
			var account1 *shared.AccountProvision
			if r.DeprovisionerPolicy.Connector.Account != nil {
				var config1 *shared.Config
				if r.DeprovisionerPolicy.Connector.Account.Config != nil {
					config1 = &shared.Config{}
				}
				connectorId4 := new(string)
				if !r.DeprovisionerPolicy.Connector.Account.ConnectorID.IsUnknown() && !r.DeprovisionerPolicy.Connector.Account.ConnectorID.IsNull() {
					*connectorId4 = r.DeprovisionerPolicy.Connector.Account.ConnectorID.ValueString()
				} else {
					connectorId4 = nil
				}
				var doNotSave1 *shared.DoNotSave
				if r.DeprovisionerPolicy.Connector.Account.DoNotSave != nil {
					doNotSave1 = &shared.DoNotSave{}
				}
				var saveToVault1 *shared.SaveToVault
				if r.DeprovisionerPolicy.Connector.Account.SaveToVault != nil {
					var vaultIds1 []string
					if r.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds != nil {
						vaultIds1 = make([]string, 0, len(r.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds))
						for _, vaultIdsItem1 := range r.DeprovisionerPolicy.Connector.Account.SaveToVault.VaultIds {
							vaultIds1 = append(vaultIds1, vaultIdsItem1.ValueString())
						}
					}
					saveToVault1 = &shared.SaveToVault{
						VaultIds: vaultIds1,
					}
				}
				schemaId1 := new(string)
				if !r.DeprovisionerPolicy.Connector.Account.SchemaID.IsUnknown() && !r.DeprovisionerPolicy.Connector.Account.SchemaID.IsNull() {
					*schemaId1 = r.DeprovisionerPolicy.Connector.Account.SchemaID.ValueString()
				} else {
					schemaId1 = nil
				}
				account1 = &shared.AccountProvision{
					Config:      config1,
					ConnectorID: connectorId4,
					DoNotSave:   doNotSave1,
					SaveToVault: saveToVault1,
					SchemaID:    schemaId1,
				}
			}
			var defaultBehavior1 *shared.DefaultBehavior
			if r.DeprovisionerPolicy.Connector.DefaultBehavior != nil {
				connectorId5 := new(string)
				if !r.DeprovisionerPolicy.Connector.DefaultBehavior.ConnectorID.IsUnknown() && !r.DeprovisionerPolicy.Connector.DefaultBehavior.ConnectorID.IsNull() {
					*connectorId5 = r.DeprovisionerPolicy.Connector.DefaultBehavior.ConnectorID.ValueString()
				} else {
					connectorId5 = nil
				}
				defaultBehavior1 = &shared.DefaultBehavior{
					ConnectorID: connectorId5,
				}
			}
			var deleteAccount1 *shared.DeleteAccount
			if r.DeprovisionerPolicy.Connector.DeleteAccount != nil {
				connectorId6 := new(string)
				if !r.DeprovisionerPolicy.Connector.DeleteAccount.ConnectorID.IsUnknown() && !r.DeprovisionerPolicy.Connector.DeleteAccount.ConnectorID.IsNull() {
					*connectorId6 = r.DeprovisionerPolicy.Connector.DeleteAccount.ConnectorID.ValueString()
				} else {
					connectorId6 = nil
				}
				deleteAccount1 = &shared.DeleteAccount{
					ConnectorID: connectorId6,
				}
			}
			connector1 = &shared.ConnectorProvision{
				Account:         account1,
				DefaultBehavior: defaultBehavior1,
				DeleteAccount:   deleteAccount1,
			}
		}
		var delegated1 *shared.DelegatedProvision
		if r.DeprovisionerPolicy.Delegated != nil {
			appId3 := new(string)
			if !r.DeprovisionerPolicy.Delegated.AppID.IsUnknown() && !r.DeprovisionerPolicy.Delegated.AppID.IsNull() {
				*appId3 = r.DeprovisionerPolicy.Delegated.AppID.ValueString()
			} else {
				appId3 = nil
			}
			entitlementId1 := new(string)
			if !r.DeprovisionerPolicy.Delegated.EntitlementID.IsUnknown() && !r.DeprovisionerPolicy.Delegated.EntitlementID.IsNull() {
				*entitlementId1 = r.DeprovisionerPolicy.Delegated.EntitlementID.ValueString()
			} else {
				entitlementId1 = nil
			}
			delegated1 = &shared.DelegatedProvision{
				AppID:         appId3,
				EntitlementID: entitlementId1,
			}
		}
		var externalTicket1 *shared.ExternalTicketProvision
		if r.DeprovisionerPolicy.ExternalTicket != nil {
			appId4 := new(string)
			if !r.DeprovisionerPolicy.ExternalTicket.AppID.IsUnknown() && !r.DeprovisionerPolicy.ExternalTicket.AppID.IsNull() {
				*appId4 = r.DeprovisionerPolicy.ExternalTicket.AppID.ValueString()
			} else {
				appId4 = nil
			}
			connectorId7 := new(string)
			if !r.DeprovisionerPolicy.ExternalTicket.ConnectorID.IsUnknown() && !r.DeprovisionerPolicy.ExternalTicket.ConnectorID.IsNull() {
				*connectorId7 = r.DeprovisionerPolicy.ExternalTicket.ConnectorID.ValueString()
			} else {
				connectorId7 = nil
			}
			externalTicketProvisionerConfigId1 := new(string)
			if !r.DeprovisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.IsUnknown() && !r.DeprovisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.IsNull() {
				*externalTicketProvisionerConfigId1 = r.DeprovisionerPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.ValueString()
			} else {
				externalTicketProvisionerConfigId1 = nil
			}
			instructions2 := new(string)
			if !r.DeprovisionerPolicy.ExternalTicket.Instructions.IsUnknown() && !r.DeprovisionerPolicy.ExternalTicket.Instructions.IsNull() {
				*instructions2 = r.DeprovisionerPolicy.ExternalTicket.Instructions.ValueString()
			} else {
				instructions2 = nil
			}
			externalTicket1 = &shared.ExternalTicketProvision{
				AppID:                             appId4,
				ConnectorID:                       connectorId7,
				ExternalTicketProvisionerConfigID: externalTicketProvisionerConfigId1,
				Instructions:                      instructions2,
			}
		}
		var manual1 *shared.ManualProvision
		if r.DeprovisionerPolicy.Manual != nil {
			instructions3 := new(string)
			if !r.DeprovisionerPolicy.Manual.Instructions.IsUnknown() && !r.DeprovisionerPolicy.Manual.Instructions.IsNull() {
				*instructions3 = r.DeprovisionerPolicy.Manual.Instructions.ValueString()
			} else {
				instructions3 = nil
			}
			var userIds1 []string
			if r.DeprovisionerPolicy.Manual.UserIds != nil {
				userIds1 = make([]string, 0, len(r.DeprovisionerPolicy.Manual.UserIds))
				for _, userIdsItem1 := range r.DeprovisionerPolicy.Manual.UserIds {
					userIds1 = append(userIds1, userIdsItem1.ValueString())
				}
			}
			manual1 = &shared.ManualProvision{
				Instructions: instructions3,
				UserIds:      userIds1,
			}
		}
		var multiStep1 interface{}
		if !r.DeprovisionerPolicy.MultiStep.IsUnknown() && !r.DeprovisionerPolicy.MultiStep.IsNull() {
			_ = json.Unmarshal([]byte(r.DeprovisionerPolicy.MultiStep.ValueString()), &multiStep1)
		}
		var unconfigured1 *shared.UnconfiguredProvision
		if r.DeprovisionerPolicy.Unconfigured != nil {
			unconfigured1 = &shared.UnconfiguredProvision{}
		}
		var webhook1 *shared.WebhookProvision
		if r.DeprovisionerPolicy.Webhook != nil {
			webhookId1 := new(string)
			if !r.DeprovisionerPolicy.Webhook.WebhookID.IsUnknown() && !r.DeprovisionerPolicy.Webhook.WebhookID.IsNull() {
				*webhookId1 = r.DeprovisionerPolicy.Webhook.WebhookID.ValueString()
			} else {
				webhookId1 = nil
			}
			webhook1 = &shared.WebhookProvision{
				WebhookID: webhookId1,
			}
		}
		deprovisionerPolicy = &shared.DeprovisionerPolicy{
			Connector:      connector1,
			Delegated:      delegated1,
			ExternalTicket: externalTicket1,
			Manual:         manual1,
			MultiStep:      multiStep1,
			Unconfigured:   unconfigured1,
			Webhook:        webhook1,
		}
	}
	out := shared.AppEntitlementInput{
		Alias:                          alias,
		AppID:                          appID,
		AppResourceID:                  appResourceID,
		AppResourceTypeID:              appResourceTypeID,
		CertifyPolicyID:                certifyPolicyID,
		ComplianceFrameworkValueIds:    complianceFrameworkValueIds,
		CreatedAt:                      createdAt,
		DefaultValuesApplied:           defaultValuesApplied,
		DeletedAt:                      deletedAt,
		Description:                    description,
		DisplayName:                    displayName,
		DurationGrant:                  durationGrant,
		DurationUnset:                  durationUnset,
		EmergencyGrantEnabled:          emergencyGrantEnabled,
		EmergencyGrantPolicyID:         emergencyGrantPolicyID,
		GrantPolicyID:                  grantPolicyID,
		IsManuallyManaged:              isManuallyManaged,
		MatchBatonID:                   matchBatonID,
		OverrideAccessRequestsDefaults: overrideAccessRequestsDefaults,
		ProvisionerPolicy:              provisionerPolicy,
		Purpose:                        purpose,
		RequestSchemaID:                requestSchemaID,
		RevokePolicyID:                 revokePolicyID,
		RiskLevelValueID:               riskLevelValueID,
		Slug:                           slug,
		SourceConnectorIds:             sourceConnectorIds,
		UpdatedAt:                      updatedAt,
		DeprovisionerPolicy:            deprovisionerPolicy,
	}

	return &out, diags
}

func (r *CustomAppEntitlementResourceModel) ToSharedCreateAppEntitlementRequest(ctx context.Context) (*shared.CreateAppEntitlementRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	alias := new(string)
	if !r.Alias.IsUnknown() && !r.Alias.IsNull() {
		*alias = r.Alias.ValueString()
	} else {
		alias = nil
	}
	appResourceID := new(string)
	if !r.AppResourceID.IsUnknown() && !r.AppResourceID.IsNull() {
		*appResourceID = r.AppResourceID.ValueString()
	} else {
		appResourceID = nil
	}
	appResourceTypeID := new(string)
	if !r.AppResourceTypeID.IsUnknown() && !r.AppResourceTypeID.IsNull() {
		*appResourceTypeID = r.AppResourceTypeID.ValueString()
	} else {
		appResourceTypeID = nil
	}
	certifyPolicyID := new(string)
	if !r.CertifyPolicyID.IsUnknown() && !r.CertifyPolicyID.IsNull() {
		*certifyPolicyID = r.CertifyPolicyID.ValueString()
	} else {
		certifyPolicyID = nil
	}
	var complianceFrameworkValueIds []string
	if r.ComplianceFrameworkValueIds != nil {
		complianceFrameworkValueIds = make([]string, 0, len(r.ComplianceFrameworkValueIds))
		for _, complianceFrameworkValueIdsItem := range r.ComplianceFrameworkValueIds {
			complianceFrameworkValueIds = append(complianceFrameworkValueIds, complianceFrameworkValueIdsItem.ValueString())
		}
	}
	description := new(string)
	if !r.Description.IsUnknown() && !r.Description.IsNull() {
		*description = r.Description.ValueString()
	} else {
		description = nil
	}
	var displayName string
	displayName = r.DisplayName.ValueString()

	durationGrant := new(string)
	if !r.DurationGrant.IsUnknown() && !r.DurationGrant.IsNull() {
		*durationGrant = r.DurationGrant.ValueString()
	} else {
		durationGrant = nil
	}
	var durationUnset *shared.CreateAppEntitlementRequestDurationUnset
	if r.DurationUnset != nil {
		durationUnset = &shared.CreateAppEntitlementRequestDurationUnset{}
	}
	emergencyGrantEnabled := new(bool)
	if !r.EmergencyGrantEnabled.IsUnknown() && !r.EmergencyGrantEnabled.IsNull() {
		*emergencyGrantEnabled = r.EmergencyGrantEnabled.ValueBool()
	} else {
		emergencyGrantEnabled = nil
	}
	emergencyGrantPolicyID := new(string)
	if !r.EmergencyGrantPolicyID.IsUnknown() && !r.EmergencyGrantPolicyID.IsNull() {
		*emergencyGrantPolicyID = r.EmergencyGrantPolicyID.ValueString()
	} else {
		emergencyGrantPolicyID = nil
	}
	grantPolicyID := new(string)
	if !r.GrantPolicyID.IsUnknown() && !r.GrantPolicyID.IsNull() {
		*grantPolicyID = r.GrantPolicyID.ValueString()
	} else {
		grantPolicyID = nil
	}
	matchBatonID := new(string)
	if !r.MatchBatonID.IsUnknown() && !r.MatchBatonID.IsNull() {
		*matchBatonID = r.MatchBatonID.ValueString()
	} else {
		matchBatonID = nil
	}
	overrideAccessRequestsDefaults := new(bool)
	if !r.OverrideAccessRequestsDefaults.IsUnknown() && !r.OverrideAccessRequestsDefaults.IsNull() {
		*overrideAccessRequestsDefaults = r.OverrideAccessRequestsDefaults.ValueBool()
	} else {
		overrideAccessRequestsDefaults = nil
	}
	var provisionPolicy *shared.ProvisionPolicy
	if r.ProvisionPolicy != nil {
		var connector *shared.ConnectorProvision
		if r.ProvisionPolicy.Connector != nil {
			var account *shared.AccountProvision
			if r.ProvisionPolicy.Connector.Account != nil {
				var config *shared.Config
				if r.ProvisionPolicy.Connector.Account.Config != nil {
					config = &shared.Config{}
				}
				connectorID := new(string)
				if !r.ProvisionPolicy.Connector.Account.ConnectorID.IsUnknown() && !r.ProvisionPolicy.Connector.Account.ConnectorID.IsNull() {
					*connectorID = r.ProvisionPolicy.Connector.Account.ConnectorID.ValueString()
				} else {
					connectorID = nil
				}
				var doNotSave *shared.DoNotSave
				if r.ProvisionPolicy.Connector.Account.DoNotSave != nil {
					doNotSave = &shared.DoNotSave{}
				}
				var saveToVault *shared.SaveToVault
				if r.ProvisionPolicy.Connector.Account.SaveToVault != nil {
					var vaultIds []string
					if r.ProvisionPolicy.Connector.Account.SaveToVault.VaultIds != nil {
						vaultIds = make([]string, 0, len(r.ProvisionPolicy.Connector.Account.SaveToVault.VaultIds))
						for _, vaultIdsItem := range r.ProvisionPolicy.Connector.Account.SaveToVault.VaultIds {
							vaultIds = append(vaultIds, vaultIdsItem.ValueString())
						}
					}
					saveToVault = &shared.SaveToVault{
						VaultIds: vaultIds,
					}
				}
				schemaID := new(string)
				if !r.ProvisionPolicy.Connector.Account.SchemaID.IsUnknown() && !r.ProvisionPolicy.Connector.Account.SchemaID.IsNull() {
					*schemaID = r.ProvisionPolicy.Connector.Account.SchemaID.ValueString()
				} else {
					schemaID = nil
				}
				account = &shared.AccountProvision{
					Config:      config,
					ConnectorID: connectorID,
					DoNotSave:   doNotSave,
					SaveToVault: saveToVault,
					SchemaID:    schemaID,
				}
			}
			var defaultBehavior *shared.DefaultBehavior
			if r.ProvisionPolicy.Connector.DefaultBehavior != nil {
				connectorId1 := new(string)
				if !r.ProvisionPolicy.Connector.DefaultBehavior.ConnectorID.IsUnknown() && !r.ProvisionPolicy.Connector.DefaultBehavior.ConnectorID.IsNull() {
					*connectorId1 = r.ProvisionPolicy.Connector.DefaultBehavior.ConnectorID.ValueString()
				} else {
					connectorId1 = nil
				}
				defaultBehavior = &shared.DefaultBehavior{
					ConnectorID: connectorId1,
				}
			}
			var deleteAccount *shared.DeleteAccount
			if r.ProvisionPolicy.Connector.DeleteAccount != nil {
				connectorId2 := new(string)
				if !r.ProvisionPolicy.Connector.DeleteAccount.ConnectorID.IsUnknown() && !r.ProvisionPolicy.Connector.DeleteAccount.ConnectorID.IsNull() {
					*connectorId2 = r.ProvisionPolicy.Connector.DeleteAccount.ConnectorID.ValueString()
				} else {
					connectorId2 = nil
				}
				deleteAccount = &shared.DeleteAccount{
					ConnectorID: connectorId2,
				}
			}
			connector = &shared.ConnectorProvision{
				Account:         account,
				DefaultBehavior: defaultBehavior,
				DeleteAccount:   deleteAccount,
			}
		}
		var delegated *shared.DelegatedProvision
		if r.ProvisionPolicy.Delegated != nil {
			appID := new(string)
			if !r.ProvisionPolicy.Delegated.AppID.IsUnknown() && !r.ProvisionPolicy.Delegated.AppID.IsNull() {
				*appID = r.ProvisionPolicy.Delegated.AppID.ValueString()
			} else {
				appID = nil
			}
			entitlementID := new(string)
			if !r.ProvisionPolicy.Delegated.EntitlementID.IsUnknown() && !r.ProvisionPolicy.Delegated.EntitlementID.IsNull() {
				*entitlementID = r.ProvisionPolicy.Delegated.EntitlementID.ValueString()
			} else {
				entitlementID = nil
			}
			delegated = &shared.DelegatedProvision{
				AppID:         appID,
				EntitlementID: entitlementID,
			}
		}
		var externalTicket *shared.ExternalTicketProvision
		if r.ProvisionPolicy.ExternalTicket != nil {
			appId1 := new(string)
			if !r.ProvisionPolicy.ExternalTicket.AppID.IsUnknown() && !r.ProvisionPolicy.ExternalTicket.AppID.IsNull() {
				*appId1 = r.ProvisionPolicy.ExternalTicket.AppID.ValueString()
			} else {
				appId1 = nil
			}
			connectorId3 := new(string)
			if !r.ProvisionPolicy.ExternalTicket.ConnectorID.IsUnknown() && !r.ProvisionPolicy.ExternalTicket.ConnectorID.IsNull() {
				*connectorId3 = r.ProvisionPolicy.ExternalTicket.ConnectorID.ValueString()
			} else {
				connectorId3 = nil
			}
			externalTicketProvisionerConfigID := new(string)
			if !r.ProvisionPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.IsUnknown() && !r.ProvisionPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.IsNull() {
				*externalTicketProvisionerConfigID = r.ProvisionPolicy.ExternalTicket.ExternalTicketProvisionerConfigID.ValueString()
			} else {
				externalTicketProvisionerConfigID = nil
			}
			instructions := new(string)
			if !r.ProvisionPolicy.ExternalTicket.Instructions.IsUnknown() && !r.ProvisionPolicy.ExternalTicket.Instructions.IsNull() {
				*instructions = r.ProvisionPolicy.ExternalTicket.Instructions.ValueString()
			} else {
				instructions = nil
			}
			externalTicket = &shared.ExternalTicketProvision{
				AppID:                             appId1,
				ConnectorID:                       connectorId3,
				ExternalTicketProvisionerConfigID: externalTicketProvisionerConfigID,
				Instructions:                      instructions,
			}
		}
		var manual *shared.ManualProvision
		if r.ProvisionPolicy.Manual != nil {
			instructions1 := new(string)
			if !r.ProvisionPolicy.Manual.Instructions.IsUnknown() && !r.ProvisionPolicy.Manual.Instructions.IsNull() {
				*instructions1 = r.ProvisionPolicy.Manual.Instructions.ValueString()
			} else {
				instructions1 = nil
			}
			var userIds []string
			if r.ProvisionPolicy.Manual.UserIds != nil {
				userIds = make([]string, 0, len(r.ProvisionPolicy.Manual.UserIds))
				for _, userIdsItem := range r.ProvisionPolicy.Manual.UserIds {
					userIds = append(userIds, userIdsItem.ValueString())
				}
			}
			manual = &shared.ManualProvision{
				Instructions: instructions1,
				UserIds:      userIds,
			}
		}
		var multiStep interface{}
		if !r.ProvisionPolicy.MultiStep.IsUnknown() && !r.ProvisionPolicy.MultiStep.IsNull() {
			_ = json.Unmarshal([]byte(r.ProvisionPolicy.MultiStep.ValueString()), &multiStep)
		}
		var unconfigured *shared.UnconfiguredProvision
		if r.ProvisionPolicy.Unconfigured != nil {
			unconfigured = &shared.UnconfiguredProvision{}
		}
		var webhook *shared.WebhookProvision
		if r.ProvisionPolicy.Webhook != nil {
			webhookID := new(string)
			if !r.ProvisionPolicy.Webhook.WebhookID.IsUnknown() && !r.ProvisionPolicy.Webhook.WebhookID.IsNull() {
				*webhookID = r.ProvisionPolicy.Webhook.WebhookID.ValueString()
			} else {
				webhookID = nil
			}
			webhook = &shared.WebhookProvision{
				WebhookID: webhookID,
			}
		}
		provisionPolicy = &shared.ProvisionPolicy{
			Connector:      connector,
			Delegated:      delegated,
			ExternalTicket: externalTicket,
			Manual:         manual,
			MultiStep:      multiStep,
			Unconfigured:   unconfigured,
			Webhook:        webhook,
		}
	}
	purpose := new(shared.CreateAppEntitlementRequestPurpose)
	if !r.Purpose.IsUnknown() && !r.Purpose.IsNull() {
		*purpose = shared.CreateAppEntitlementRequestPurpose(r.Purpose.ValueString())
	} else {
		purpose = nil
	}
	revokePolicyID := new(string)
	if !r.RevokePolicyID.IsUnknown() && !r.RevokePolicyID.IsNull() {
		*revokePolicyID = r.RevokePolicyID.ValueString()
	} else {
		revokePolicyID = nil
	}
	riskLevelValueID := new(string)
	if !r.RiskLevelValueID.IsUnknown() && !r.RiskLevelValueID.IsNull() {
		*riskLevelValueID = r.RiskLevelValueID.ValueString()
	} else {
		riskLevelValueID = nil
	}
	slug := new(string)
	if !r.Slug.IsUnknown() && !r.Slug.IsNull() {
		*slug = r.Slug.ValueString()
	} else {
		slug = nil
	}
	out := shared.CreateAppEntitlementRequest{
		Alias:                          alias,
		AppResourceID:                  appResourceID,
		AppResourceTypeID:              appResourceTypeID,
		CertifyPolicyID:                certifyPolicyID,
		ComplianceFrameworkValueIds:    complianceFrameworkValueIds,
		Description:                    description,
		DisplayName:                    displayName,
		DurationGrant:                  durationGrant,
		DurationUnset:                  durationUnset,
		EmergencyGrantEnabled:          emergencyGrantEnabled,
		EmergencyGrantPolicyID:         emergencyGrantPolicyID,
		GrantPolicyID:                  grantPolicyID,
		MatchBatonID:                   matchBatonID,
		OverrideAccessRequestsDefaults: overrideAccessRequestsDefaults,
		ProvisionPolicy:                provisionPolicy,
		Purpose:                        purpose,
		RevokePolicyID:                 revokePolicyID,
		RiskLevelValueID:               riskLevelValueID,
		Slug:                           slug,
	}

	return &out, diags
}

func (r *CustomAppEntitlementResourceModel) ToSharedUpdateAppEntitlementRequest(ctx context.Context) (*shared.UpdateAppEntitlementRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	entitlement, entitlementDiags := r.ToSharedAppEntitlementInput(ctx)
	diags.Append(entitlementDiags...)

	if diags.HasError() {
		return nil, diags
	}

	overrideAccessRequestsDefaults := new(bool)
	if !r.OverrideAccessRequestsDefaults.IsUnknown() && !r.OverrideAccessRequestsDefaults.IsNull() {
		*overrideAccessRequestsDefaults = r.OverrideAccessRequestsDefaults.ValueBool()
	} else {
		overrideAccessRequestsDefaults = nil
	}
	out := shared.UpdateAppEntitlementRequest{
		Entitlement:                    entitlement,
		OverrideAccessRequestsDefaults: overrideAccessRequestsDefaults,
	}

	return &out, diags
}
